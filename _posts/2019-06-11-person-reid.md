---
title: Ре-идентификация людей
date: 2019-06-11
minutes: 6
---

В этом посте мы расскажем о том, как за счет алгоритмов ре-идентификации:
* ретейлеры собирают аналитику по посетителям магазинов
* супермаркеты борются с внутренним мошенничеством на кассе
* службы безопасности ищут преступников

### Проблема

Иногда случается так, что нам не доступны изображения лиц на видео, например когда
в продуктовом магазине камеры висят на потолке, и поэтому мы не можем использовать
технологию распознавания лиц.

_Когда покупатели проходят около камеры, лица можно распознать:_

<img src="/assets/images/face_detected.jpg" alt="Лица можно распознать">

_Когда камеры висят высоко, лица распознать невозможно:_

<img src="/assets/images/faces_not_detected.jpg" alt="Невозможно распознать лица">

### Решение

В данном случае используется технология **ре-идентификации** т.е. идентификация по силуэту и одежде.
Данный подход очень схож с идентификацией по лицу, однако есть некоторые нюансы.
Ре-идентификация доступна только в течение 1 дня, т.к. на следующий день человек может придти
в новой одежде. Также такой вариант менее точен по сравнению с распознаванием лиц, но его
можно использовать с любого ракурса по отношению к человеку, тогда как в распознавании лиц
используется фронтальное изображение.

##### Что это из себя представляет?
- Поиск людей на изображении или на видеоряде с помощью алгоритмов детекции.

<img src="/assets/images/people_detection.jpg" alt="Детекция людей">

- Обработка вырезанных изображений специально обученной нейронной сетью для создания отличительных атрибутов человека.
- Сравнение каждой пары атрибутов для нахождения изображений, принадлежащих одному и тому же человеку.

<img src="/assets/images/people_look_alike.png" alt="Найденные пары людей">
<a href="https://www.groundai.com/" style="font-size: 8px;">источник</a>

##### Насколько хорошо это работает?
- лучшие алгоритмы показывают точность до **95%** на открытых данных
- нашей команде удалось достичь комбинированную метрику точности выше **93%**
на собственном наборе данных.

<img src="/assets/images/reid_grouping.png" alt="Группировка изображения с помощью алгоритма ре-идентификации">

### Примеры применения технологии ре-идентификации

##### Поиск преступника по городским камерам

Представьте ситуацию, что произошло преступление, и одна из уличных камер записала момент преступления.
Естественно, с городских камер нам не доступны лица, поэтому в данном случае можно применять технологию
ре-идентификации: вырезается образ преступника с доступного видео и производится автоматический поиск по
всем городским камерам, чтобы выявить маршруты движения злоумышленника. Алгоритм способен за 10 минут "просмотреть"
час видеосъемки сразу на нескольких камерах, т.е. при наличии 5 камер данный подход быстрее традиционного ручного
подхода в **30** раз.

<img src="/assets/images/query_gallery.png" alt="Поиск схожих людей по заданному изображению">
<a href="https://www.researchgate.net/" style="font-size: 8px;">источник</a>


##### Клиентская аналитика

Ретейлерам часто интересно знать, сколько уникальных клиентов приходит на точку в течение дня.
Но сделать это практически невозможно, так как в торговых центрах или крупных супермаркетах
всегда несколько входов и выходов, а человек не может просматривать видеозаписи с нескольких
устройств, чтобы посчитать количество уникальных клиентов. В таких случаях применяется технология
ре-идентификации людей, которая позволяет найти одних и тех же людей с разных камер и в разное время
в течение дня. Кроме того, можно отследить маршруты движения покупателей.

##### Борьба с мошенничеством на кассе

Большая часть воровства случается на кассе, где у работников есть доступ к наличным средствам. Кассиры могут
маскировать воровство под возврат или отмену операций, когда покупатели уже ушли и не захватили чек. Для анти-фрод
специалистов это большая нагрузка - просматривать все случаи отмены и возврата каждый день. С использованием ре-идентификации
можно сократить объем работы специалистов на **85%** без потери качества обнаружения мошенников.

_До и во время отмены чека один и тот же покупатель перед кассой:_

<img src="/assets/images/not_reid_fraud.jpg" alt="Не мошенничество">

_Во время отмены чека другой покупатель перед кассой:_

<img src="/assets/images/reid_fraud.jpg" alt="Во время отмены чека другой покупатель перед кассой">
