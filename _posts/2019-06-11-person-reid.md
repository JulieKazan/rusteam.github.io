---
title: Ре-идентификация людей
date: 2019-06-11
minutes: 6
author: Rustem G.
---

В этом посте расскажу об алгоритмах ре-идентификации – идентификации по силуэту и одежде. Это технология востребована в случаях, когда невозможно распознать человека по лицу или другим биометрическим признакам.

С помощью ре-идентификации:
– ретейлеры собирают аналитику по посетителям магазинов
– супермаркеты борются с мошенничествами продавцов на кассах
– службы безопасности ищут преступников

### Проблема

Иногда нам не доступны изображения лиц на видео. Например когда в продуктовом магазине камеры висят на потолке и не способны снять достаточно четкое видео, чтобы можно было применить технологию распознавания лиц.

_Когда люди проходят рядом с камерой лица легко распознать:_

<img src="/assets/images/face_detected.jpg" alt="Лица можно распознать">
<a href="https://www.facefirst.com/" style="font-size: 8px;">источник</a>

_А вот изображение с камеры, снимающей видео на расстоянии:_

<img src="/assets/images/faces_not_detected.jpg" alt="Невозможно распознать лица"  style="border-radius: 5px;>

### Решение

Как решение предлагаю технологию ре-идентификации. Этот подход очень схож с идентификацией по лицу, однако есть некоторые нюансы. Ре-идентификация доступна только в течение короткого времени, как правило, в течение одного дня. На следующий день человек может сменить одежду. Такой вариант менее точен по сравнению с распознаванием лиц, но его можно использовать с любого ракурса, тогда как в распознавании лиц используется фронтальное изображение.

##### Более подробно о ре-идентификации

Если разбить ре-идентификацию на составные части, то эта технология состоит из трех основных атрибутов:
1. Поиска людей на изображении или на видеоряде с помощью алгоритмов детекции.

<img src="/assets/images/people_detection.jpg" alt="Детекция людей" style="border-radius: 5px;">

2. Обработки вырезанных изображений специально обученной нейронной сетью для создания отличительных деталей внешнего вида человека.
3. Сравнения каждой пары деталей внешнего вида для выявления изображений одного и того же человека.

<img src="/assets/images/people_look_alike.png" alt="Найденные пары людей">
<a href="https://www.groundai.com/" style="font-size: 8px;">источник</a>

##### Насколько хорошо это работает?

Технологии ре-идентификации показывают качество идентификации немного выше 70%. Однако в зависимости от решаемых задач можно увеличить точность алгоритма до более высоких значений. После исследования нескольких подходов к ре-идентификации и тонкой настройки алгоритмов на собственном наборе данных мы смогли добиться точности 96% в кейсах по выявлению мошенничества на кассах.

<img src="/assets/images/reid_grouping.png" alt="Группировка изображения с помощью алгоритма ре-идентификации">

### Примеры применения технологии ре-идентификации

##### Поиск преступника по городским камерам

Представьте, что произошло преступление, и одна из уличных камер записала этот момент. Из-за невысокого качества изображения с обычных городских камер не доступны лица. Поэтому в этом случае лучше применить технологию ре-идентификации. Для этого нужно вырезать образ преступника с доступного видео и произвести автоматический поиск по всем городским камерам, чтобы выявить маршруты движения злоумышленника.

Алгоритм способен за 10 минут "просмотреть" час видеосъемки сразу на нескольких камерах. При наличии пяти камер подход ре-идентификации быстрее традиционного ручного подхода в **30** раз.

<img src="/assets/images/query_gallery.png" alt="Поиск схожих людей по заданному изображению">
<a href="https://www.researchgate.net/" style="font-size: 8px;">источник</a>


##### Клиентская аналитика

Ретейлерам часто интересно знать, сколько уникальных клиентов приходит на точку в течение дня. “Вручную” подсчитать это число  практически невозможно, так как в торговых центрах или крупных супермаркетах всегда несколько входов и выходов.

Технология ре-идентификации позволяет просматривать видеозаписи с нескольких устройств и подсчитать количество уникальных клиентов. Алгоритм позволяет найти одних и тех же людей с разных камер и в разное время в течение дня. Кроме того, можно отследить маршруты движения покупателей.

##### Борьба с мошенничеством на кассе

Большая часть воровства случается на кассах, где у сотрудников магазинов есть доступ к наличным средствам. Кассиры могут маскировать воровство под возврат или отмену операций, когда покупатели уже ушли и не захватили чек. Для анти-фрод специалистов это большая нагрузка – просматривать все случаи отмены и возврата каждый день.

С использованием ре-идентификации можно сократить объем работы специалистов на **85%** без потери качества обнаружения мошенников.

_До и во время отмены чека один и тот же покупатель перед кассой:_

<img src="/assets/images/not_reid_fraud.jpg" alt="Не мошенничество"  style="border-radius: 5px;">

_Во время отмены чека другой покупатель перед кассой:_

<img src="/assets/images/reid_fraud.jpg" alt="Во время отмены чека другой покупатель перед кассой"  style="border-radius: 5px;">

### Заключение

В статье приведены наиболее распространенные кейсы применения алгоритмов ре-идентификации. Однако жизненных ситуаций, в которых востребована эта технология, может быть намного больше.

С ростом применения идентификации по лицу будет расти потребность в ре-идентификации. Большинство уличных и внутренних камер не обладают четким разрешением для идентификации лиц, но их возможностей достаточно для распознавания силуэтов и одежды.
